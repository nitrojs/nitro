---
icon: i-lucide-layers
---

# Lifecycle

> Understand how Nitro runs and serves incoming requests to your application.

::warning
Nitro v3 Alpha docs are a work in progress â€” expect updates, rough edges, and occasional inaccuracies.
::

A request can be intercepted and terminated (with or without a response) from any of these layers, in this order:

::steps
<!-- ### Server hook: `request`

This server hook is the first piece of code being called for an incoming request, you can define it within a server plugin:

```ts [plugins/request-hoook.ts]
export default (nitroApp) => {
  nitroApp.hooks.hook('request', ({ req }) => {
    console.log(`Incoming request on ${req.url}`)
  })
}
```

::note
This hook cannot alter or terminate the incoming request, you can use it for logging the incoming requests or analytics purpose.
:: -->

### Route rules

The matching route rule defined in the Nitro config will execute. Note that most of the route rules can alter the response without terminating it (for instance, adding a header).

```ts [nitro.config.ts]
import { defineNitroConfig } from "nitro/config";

export default defineNitroConfig({
  routeRules: {
    '/**': { headers: { 'x-nitro': 'first' } }
  }
})
```

:read-more{to="/docs/routing#route-rules" title="Routing > Route rules"}

### Global middleware

Any global middleware defined in the `middleware/` directory will be run:

```ts [middleware/info.ts]
import { defineHandler } from "nitro/h3";

export default defineHandler((event) => {
  event.context.info = { name: "Nitro" };
});
```

::warning
Returning from a middleware will close the request and should be avoided when possible.
::

::read-more{to="/docs/middleware"}
Learn more about Nitro middleware.
::

### Server entry

If defined, the server entry handler will be run:

```ts [server.ts]
import { defineHandler } from "nitro/deps/h3";

export default defineHandler((event) => {
  if (event.path === "/") {
    return "Home page";
  }
});
```

::tip
Think of the server entry as the last global middleware to run.
::

::read-more{to="/docs/server-entry"}
Learn more about Nitro server entry.
::

### Routes

At this stage, Nitro will look at defined routes in the `routes/` folder to match the incoming request.

```ts [routes/api/hello.ts]
export default (event) => ({ world: true })
```

::read-more{to="/docs/routing#filesystem-routing"}
Learn more about Nitro file-system routing.
::

### Renderer

If no route is matched, Nitro will look for a renderer handler (defined or auto-detected) to handle the request.

::read-more{to="/docs/renderer"}
Learn more about Nitro renderer.
::

::
